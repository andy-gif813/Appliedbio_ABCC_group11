scale_colour_manual(values= c("cornflowerblue","indianred")) +
ggtitle("Scatterplot of sleep shifts vs awakening") +
theme_minimal() +
theme(axis.text = element_text(size=10),
title = element_text(size = 14),
legend.position = "bottom") +
geom_smooth(method = "lm",colour="black")+
# aes=aesthetics x軸y軸資料
# geom_決定哪一種圖, colour=""決定圖的顏色royalblue,indianred, 也可以用aes來利用一個變數來決定顏色, size 可以改變點的大小
# labs = label 是用來定x,y軸的名字，也可以決定顏色色標的名字
# scale_colour_可以讓點的顏色變自己想要的,manual 可以自訂
# ggtitle 決定標題
# theme_可以決定圖的背景顏色
# theme可以調整字的大小，axis.text可以調整x軸的大小
# geom_smooth可以加入趨勢線，method 可以自訂哪種線lm是linear method
# geom_text 可以為每個點加入註釋，
```
ggplot(data = mab, mapping = aes(x = awakenings, y = nr_of_shifts)) +
geom_point(aes(colour=dreem_record_endpoints_version), size = 2,shape=9)+
labs(x= "Awakenings", y="Number of shifts", colour="Timezone") +
scale_colour_manual(values= c("cornflowerblue","indianred")) +
ggtitle("Scatterplot of sleep shifts vs awakening") +
theme_minimal() +
theme(axis.text = element_text(size=10),
title = element_text(size = 14),
legend.position = "bottom") +
geom_smooth(method = "lm",colour="black")
ggplot(data = mab, mapping = aes(x = awakenings, y = nr_of_shifts)) +
geom_point(aes(colour=dreem_record_endpoints_version), size = 2,shape=9)+
labs(x= "Awakenings", y="Number of shifts", colour="Timezone") +
scale_colour_manual(values= c("cornflowerblue","indianred")) +
ggtitle("Scatterplot of sleep shifts vs awakening") +
theme_minimal() +
theme(axis.text = element_text(size=10),
title = element_text(size = 14),
legend.position = "bottom") +
geom_smooth(method = ,colour="black")
"lm"
ggplot(data = mab, mapping = aes(x = awakenings, y = nr_of_shifts)) +
geom_point(aes(colour=dreem_record_endpoints_version), size = 2,shape=9)+
labs(x= "Awakenings", y="Number of shifts", colour="Timezone") +
scale_colour_manual(values= c("cornflowerblue","indianred")) +
ggtitle("Scatterplot of sleep shifts vs awakening") +
theme_minimal() +
theme(axis.text = element_text(size=10),
title = element_text(size = 14),
legend.position = "bottom") +
geom_smooth(method = "lm",colour="black")
ggplot(data = mab, mapping = aes(x=rem_duration)) +
geom_density()
ggplot(data = mab, mapping = aes(x=rem_duration)) +
geom_histogram(bins = 50)
ggplot(data = mab, mapping = aes(x=device)) +
geom_bar()
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate)) +
geom_point()
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate)) +
geom_violin()
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate)) +
geom_point()+
geom_violin()
ggplot(data = mab, mapping= aes(x = average_respiration_rate, y=device)) +
geom_density_ridges()
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate)) +
geom_bar()
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate)) +
geom_bar(stat="identity")
View(mab)
aggregate(average_respiration_rate ~ device, data = mab, FUN=mean)
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate)) +
geom_bar(stat="summary")
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate)) +
geom_bar(stat="summary")
ggplot(data = mab, mapping= aes(x=device, y = average_respiration_rate,
fill = dreem_record_endpoints_version)) +
geom_bar(stat="summary", position = "dodge") +
stat_summary(geom = "errorbar",  position= position_dodge(.9), width = 0.2)
ggplot(mab, aes(x=dreem_record_endpoints_version,
y = average_respiration_rate)) +
geom_boxplot() +
stat_compare_means()
ggplot(mab, aes(x=dreem_record_endpoints_version,
y = average_respiration_rate)) +
geom_boxplot() +
stat_compare_means(method = "t.test")
shiny::runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
data <- data.frame(
gene_symbol = rep(c("GeneA", "GeneB", "GeneC", "GeneD", "GeneE"), each = 3),
phenotype = rep(c("Weight", "Images", "Brain"), times = 5),
score = rnorm(15, mean = 0, sd = 2)
)
data
data <- data.frame(
gene_symbol = rep(c("GeneA", "GeneB", "GeneC", "GeneD", "GeneE"), each = 3),
phenotype = rep(c("Weight", "Images", "Brain"), times = 5),
score = rnorm(15, mean = 0.5, sd = 0.2)
)
data
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
data <- data.frame(
gene_symbol = rep(c("GeneA", "GeneB", "GeneC", "GeneD", "GeneE"), each = 3),
phenotype = rep(c("Weight", "Images", "Brain"), times = 100),
score = rnorm(300, mean = 0.5, sd = 0.2)
)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
data
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/readmes/DCDM_group_coursework')
clean_data <- read.csv("~/Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/clean_input_files/cleaned_analysis_data.csv",
header = TRUE,   # 第一列是欄位名稱
sep = ",",       # CSV 的分隔符號
stringsAsFactors = FALSE)  # 不自動轉成 factor
View(clean_data)
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/q2shiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/q2shiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/q2shiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/q2shiny.R')
filter(clean_data, gene_symbol == "Ube2j2")
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/q2shiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Merge_all_Rshiny')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
cleaned_analysisid <- clean_data %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_analysisid
cleaned_parameterid <- cleaned_analysisid %>% group_by(
analysis_id,
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_analysisid <- clean_data %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_parameterid <- cleaned_analysisid %>% group_by(
analysis_id,
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
rlang::last_trace()
View(cleaned_analysisid)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
View(clean_data)
names(clean_data)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
cleaned_analysisid <- clean_data %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_analysisid
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
names(clean_data)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
clean_analysisid <- clean_data %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
View(clean_data)
cleaned_analysisid <- clean_data %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
cleaned_analysisid2<- clean_data %>% group_by(
#gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
#parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_analysisid2
cleaned_analysisid2<- clean_data %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
#parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_analysisid2<- cleaned_analysisid %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
#parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_analysisid2<- cleaned_analysisid %>% group_by(
gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
#parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
cleaned_analysisid2
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
View(cleaned_parameterid)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1115_V1.R')
IMPC_analysis <- read.csv("~/Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/clean_input_files/IMPC_analysis.csv")
View(IMPC_analysis)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1115_V1.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1115_V1.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1115_V1.R')
install.packages("reshape2")
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1115_V1.R')
install.packages("reshape2")
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1115_V1.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
cleaned_analysisid <- clean_data %>% group_by(
#gene_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
View(clean_data)
View(cleaned_analysisid)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
install.packages("reshape2")
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1121_V2.R')
IMPC_analysis <- read.csv("~/Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/clean_input_files/IMPC_analysis.csv")
View(IMPC_analysis)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1121_V2.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Q3_Rshiny_1121_V2.R')
install.packages('heatmaply')
"heatmaplyOutput" %in% ls("package:shinyHeatmaply")
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
View(cleaned_analysisid)
View(cleaned_analysisid)
cleaned_analysisid <- clean_data %>% group_by(
mgi_accession_id,
gene_symbol,
mouse_life_stage,
mouse_strain,
parameter_id,
parameter_name
) %>%
slice_min(order_by = pvalue, n = 1, with_ties = FALSE) %>%
ungroup()
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny)
library(ggplot2)
library(plotly)
library(dplyr)
library(reshape2)
library(heatmaply)
library(tidyr)
library(viridis)
clean_data <- read.csv("./clean_input_files/IMPC_analysis.csv",
header = TRUE, sep = ",", stringsAsFactors = FALSE)
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
source("/Users/zhouzhean/Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R")
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
View(cleaned_analysisid)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny.R')
View(cleaned_analysisid)
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/merge_all_Rshiny-fixed.R')
library(shiny); runApp('Desktop/Data_cleaning_and_management/DCDM_25_26/DCDM_group_coursework/Rshiny/Rshiny_app.R')
install.packages("BiocManager")
BiocManager::install("DESeq2")
# 1. Load packages
library(BiocManager)
#BiocManager::install("DESeq2")
library(DESeq2)
counts <- read.csv("./count_matrix.csv", header = TRUE, row.names = 1)
# 2. Read data
counts <- read.csv("./TPM.csv", header = TRUE, row.names = 1)
# 2. Read data
getwd()
setwd("~/Desktop/ABCC/Github/DESeq/")
counts <- read.csv("./TPM.csv", header = TRUE, row.names = 1)
sample_info <- read.table("./sample_info.txt", header = TRUE, row.names = 1)
orf<-read.csv("~/Desktop/ORF.csv",header = FALSE)
orf<-read.csv("./ORF.csv",header = FALSE)
# Round expression counts to integers
counts_int <- round(counts)
# Set wild_type as the reference level
sample_info$condition <- factor(sample_info$condition,
levels = c("wild_type", "engineered"))
# Extract Verified ORFs from SGD
f_orf<-orf[grepl("Verified", orf[, 2]), ]
# 3. Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = counts_int,
colData = sample_info,
design = ~ condition)
# 4. Filter low-expression genes
keep <- rowSums(counts(dds)) >0
dds <- dds[keep, ]
# 5. Run differential analysis
dds <- DESeq(dds)
# 6. Get results
res <- results(dds, contrast = c("condition", "wild_type","engineered"),alpha = 0.001)
# 7. Extract significant genes
sig_genes <- subset(res, padj < 0.001 & abs(log2FoldChange) >=1)
# Extract Verified ORF genes
sig_genes<-data.frame(sig_genes)
a<-sig_genes[order(sig_genes$pvalue),]
sig_genes<- cbind(ID = rownames(sig_genes), sig_genes)
o_sig_genes <- merge(sig_genes,f_orf, by.x = colnames(sig_genes)[1],
by.y = colnames(f_orf)[1])
# 9. Generate heatmap
# Normalize expression data
dds_rlog <- rlog(dds, blind = FALSE)
rlog_counts <- assay(dds_rlog)
# Create color gradient
my_col <- colorRampPalette(c("blue","cyan","green","yellow", "orange","red"))(100)
# Plot gene expression heatmap
pheatmap(rlog_counts,
color = my_col,
cluster_rows = TRUE,
cluster_cols = TRUE,
display_numbers = FALSE,
show_rownames = FALSE,
fontsize = 15,
breaks = seq(min(rlog_counts), max(rlog_counts), length.out = 100)
)
library(BiocManager)
#BiocManager::install("DESeq2")
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
u
# Plot gene expression heatmap
pheatmap(rlog_counts,
color = my_col,
cluster_rows = TRUE,
cluster_cols = TRUE,
display_numbers = FALSE,
show_rownames = FALSE,
fontsize = 15,
breaks = seq(min(rlog_counts), max(rlog_counts), length.out = 100)
)
#10 Calculate Pearson correlation between samples
cor_matrix <- cor(counts, method = "pearson")
cat("Total number of genes:", nrow(res), "\n")
cat("Number of significant differentially expressed genes:", nrow(sig_genes), "\n")
cat("Number of Verified ORF genes:", nrow(o_sig_genes), "\n")
cat("Total number of genes:", nrow(res), "\n")
cat("Number of significant differentially expressed genes:", nrow(sig_genes), "\n")
View(o_sig_genes)
cat("Number of Verified ORF genes:", nrow(o_sig_genes), "\n")
cat("Number of significant differentially expressed genes:", nrow(sig_genes), "\n")
View(sig_genes)
View(sig_genes)
View(o_sig_genes)
View(sig_genes)
